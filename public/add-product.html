<!DOCTYPE html>
<html>
<head>
  <title>Products</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body>
  <div class="container mt-4">
    <h3>Add Products</h3>
    <table class="table table-striped">
      <thead>
        <tr>
          <th>ID</th>
          <th>Name</th>
          <th>Price ($)</th>
          <th>Cost ($)</th>
          <th>Stock</th>
          <th>Storage Location</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody id="productsTable"></tbody>
    </table>
    <button class="btn btn-primary" id="addProductBtn">Add Product</button>
  </div>

  <script>
    function loadProducts() {
      window.api.fetchProducts()
        .then(products => {
          const tbody = document.getElementById('productsTable');
          tbody.innerHTML = '';
          products.forEach(product => {
            const row = document.createElement('tr');
            row.innerHTML = `
              <td>${product.id}</td>
              <td>${product.name}</td>
              <td>${product.price.toFixed(2)}</td>
              <td>${product.cost ? product.cost.toFixed(2) : 'N/A'}</td>
              <td>${product.stock}</td>
              <td>${product.storage_location}</td>
              <td>
                <button class="btn btn-sm btn-warning edit-btn" data-id="${product.id}">Edit</button>
                <button class="btn btn-sm btn-danger delete-btn" data-id="${product.id}">Delete</button>
              </td>
            `;
            tbody.appendChild(row);
          });

          document.querySelectorAll('.edit-btn').forEach(btn => {
            btn.addEventListener('click', () => {
              const id = btn.getAttribute('data-id');
              window.api.send('open-edit-product-window', id);
            });
          });

          document.querySelectorAll('.delete-btn').forEach(btn => {
            btn.addEventListener('click', () => {
              const id = btn.getAttribute('data-id');
              window.api.deleteProduct(id).then(() => loadProducts());
            });
          });
        })
        .catch(err => console.error('Error loading products:', err));
    }

    document.getElementById('addProductBtn').addEventListener('click', () => {
      window.api.send('open-add-product-window');
    });

    loadProducts();
  </script>
</body>
</html>